import Head from 'next/head'
import type { NextPage } from 'next'
import { useEffect, useState } from 'react'

import { Product } from '@/interfaces/product'
import HomeFeed from '@/components/home/home_feed'
import { fetchProducts } from '@/services/products'
import NavBar from '@/components/navigation/main_navbar'
import SidebarLeft from '@/components/sidebar/sidebar_left'
import SidebarRight from '@/components/sidebar/sidebar_right'

const Home: NextPage = () => {
  const [products, setProducts] = useState<Product[]>([])
  const [loading, setLoading] = useState<boolean>(false)

  useEffect(() => {
    // fetch products
    const fetchProductsAndAlbums = async () => {
      setLoading(true)
      const [productsRes] = await Promise.all([
        fetchProducts(),
      ])
      setProducts(productsRes)
      //setAlbums(albumsRes)
      setLoading(false)
    }
    fetchProductsAndAlbums()

    return () => {
      //clean up hook
    }
  }, []);

  return (
    <>
      <Head>
        <title>VidShop</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main className="h-screen md:h-screen">
        <NavBar />
        <div className="flex justify-center  my-16">
          <div className="hidden sm:block sm:w-1/4 bg-gray-200 h-screen">
            <SidebarLeft />
          </div>

          <div className="w-full sm:w-1/2 bg-gray-100 h-screen">
            <section>
              <HomeFeed products={products} />
            </section>
          </div>
          <div className="hidden sm:block sm:w-1/4 bg-gray-200 h-screen">
            <SidebarRight />
          </div>
        </div>
      </main>
    </>
  );
};

export default Home;
